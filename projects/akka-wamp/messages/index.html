<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <meta name="author" content="Paolo Angioletti">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Messages - akka-wamp-0.9.0</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">akka-wamp-0.9.0</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../router/">Router</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Client <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../client/actor/">Actor based API</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Future based API</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../client/future/overview/">Overview</a>
</li>

        
            
<li >
    <a href="../client/future/session/">Session Handling</a>
</li>

        
            
<li >
    <a href="../client/future/pubsub/">Publish and Subscribe</a>
</li>

        
            
<li >
    <a href="../client/future/rpc/">Remote Procedure Calls</a>
</li>

        
            
<li >
    <a href="../client/future/payload/">Payload Handling</a>
</li>

        
    </ul>
  </li>

                        
                            
<li >
    <a href="../client/stream/">Stream based API</a>
</li>

                        
                            
<li >
    <a href="../client/config/">Configuration</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">Messages</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../client/config/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#messages">Messages</a></li>
        
            <li class="second-level"><a href="#session-handling">Session Handling</a></li>
            
                <li class="third-level"><a href="#connect">Connect</a></li>
            
                <li class="third-level"><a href="#hello">Hello</a></li>
            
                <li class="third-level"><a href="#abort">Abort</a></li>
            
                <li class="third-level"><a href="#welcome">Welcome</a></li>
            
                <li class="third-level"><a href="#goodbye">Goodbye</a></li>
            
                <li class="third-level"><a href="#error">Error</a></li>
            
        
            <li class="second-level"><a href="#publish-subscribe">Publish Subscribe</a></li>
            
                <li class="third-level"><a href="#subscribe">Subscribe</a></li>
            
                <li class="third-level"><a href="#subscribed">Subscribed</a></li>
            
                <li class="third-level"><a href="#publish">Publish</a></li>
            
                <li class="third-level"><a href="#event">Event</a></li>
            
        
            <li class="second-level"><a href="#remote-procedure-calls">Remote Procedure Calls</a></li>
            
                <li class="third-level"><a href="#register">Register</a></li>
            
                <li class="third-level"><a href="#call">Call</a></li>
            
                <li class="third-level"><a href="#invoke">Invoke</a></li>
            
                <li class="third-level"><a href="#yield">Yield</a></li>
            
                <li class="third-level"><a href="#result">Result</a></li>
            
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="messages">Messages</h1>
<p>TBD </p>
<h2 id="session-handling">Session Handling</h2>
<pre><code>   ,------.                                    ,------.
   | Peer |                                    | Peer |
   `--+---'                                    `--+---'
      |               TCP established             |
      |&lt;-----------------------------------------&gt;|
      |                                           |
      |               TLS established             |
      |+&lt;---------------------------------------&gt;+|
      |+                                         +|
      |+           WebSocket established         +|
      |+|&lt;-------------------------------------&gt;|+|
      |+|                                       |+|
      |+|            WAMP established           |+|
      |+|+&lt;-----------------------------------&gt;+|+|
      |+|+                                     +|+|
      |+|+                                     +|+|
      |+|+            WAMP closed              +|+|
      |+|+&lt;-----------------------------------&gt;+|+|
      |+|                                       |+|
      |+|                                       |+|
      |+|            WAMP established           |+|
      |+|+&lt;-----------------------------------&gt;+|+|
      |+|+                                     +|+|
      |+|+                                     +|+|
      |+|+            WAMP closed              +|+|
      |+|+&lt;-----------------------------------&gt;+|+|
      |+|                                       |+|
      |+|           WebSocket closed            |+|
      |+|&lt;-------------------------------------&gt;|+|
      |+                                         +|
      |+              TLS closed                 +|
      |+&lt;---------------------------------------&gt;+|
      |                                           |
      |               TCP closed                  |
      |&lt;-----------------------------------------&gt;|
      |                                           |
   ,--+---.                                    ,--+---.
   | Peer |                                    | Peer |
   `------'                                    `------'
</code></pre>

<p><a name="Connect"></a></p>
<h3 id="connect">Connect</h3>
<p>It is the message you send to the Akka IO entry point to establish a WAMP connection to a router. It can be constructed passing the following parameters:</p>
<ul>
<li>
<p><code>client</code><br />
  It is your client actor reference to which messages from the remote router are delivered while the connection is established.</p>
</li>
<li>
<p><code>url</code><br />
  It is the <a href="https://www.ietf.org/rfc/rfc1738.txt">URL</a> to the remote router. By default Akka Wamp makes use of <code>ws://127.0.0.1:8080/ws</code> and it currently supports the following protocols:</p>
</li>
<li>
<p><code>ws</code><br />
    It is the WebSocket protocol.</p>
</li>
<li>
<p><code>subprotocol</code><br />
  It is the <a href="https://www.iana.org/assignments/websocket/websocket.xml#subprotocol-name">subprotocol</a> you wish to negotiate with the remote router.</p>
</li>
</ul>
<p>Examples:</p>
<pre><code class="scala">IO(Wamp) ! Connect(client)
IO(Wamp) ! Connect(client, url = &quot;ws://router.host.net:8080/path/to/ws&quot;)
IO(Wamp) ! Connect(client, subprotocol = &quot;wamp.2.mgspack&quot;)
</code></pre>

<p><a name="Hello"></a></p>
<h3 id="hello">Hello</h3>
<p>It is the message you send to the transport to request a new session being opened with the given realm attached plus additional details. It can be constructed passing the following parameters:</p>
<ul>
<li>
<p><code>realm</code><br />
  It is the realm identifier given as <a href="https://tools.ietf.org/html/draft-oberstet-hybi-tavendo-wamp-02#section-5.1.1">URI</a>. By default, Akka Wamp sends <code>akka.wamp.realm</code></p>
</li>
<li>
<p><code>details</code><br />
   It is a dictionary of additional details. By default, Akka Wamp makes a dictionary with all possible client roles its supports:</p>
<ul>
<li><code>subscriber</code></li>
<li><code>publisher</code></li>
</ul>
</li>
</ul>
<p>Examples:</p>
<pre><code class="scala">connection ! Hello()
connection ! Hello(&quot;myapp.realm&quot;)
connection ! Hello(details = Dict().withRoles(&quot;subscriber&quot;))
connection ! Hello(&quot;myapp.realm&quot;, Dict().withRoles(&quot;publisher&quot;))
</code></pre>

<p><a name="Abort"></a></p>
<h3 id="abort">Abort</h3>
<p>TBD</p>
<p><a name="Welcome"></a></p>
<h3 id="welcome">Welcome</h3>
<p>It is the message you receive from the remote router upon session opening. It can be deconstructed (via Scala pattern matching) to the following parameters:</p>
<ul>
<li>
<p><code>sessionId</code><br />
  It is the session identifier as generated by the remote router.</p>
</li>
<li>
<p><code>details</code><br />
  It is a dictionary with additional details (for example the remote router agent identifier)</p>
</li>
</ul>
<p>Examples:</p>
<pre><code class="scala">val sessionId: Long = _

def receive: Receive = {
  case Welcome(sessionId, details) =&gt;
    log info s&quot;Session $sessionId opened with $details&quot;
    this.sessionId = sessionId
    context become opened
}

def opened: Receive = {
  case Goodbye =&gt;
    this.sessionId = 0

  // case ...  
}
</code></pre>

<p><a name="Goodbye"></a></p>
<h3 id="goodbye">Goodbye</h3>
<p>It is the message either you send to the transport or receive from the remote router to request session closing. It can be constructed (deconstructed) with (to) the following parameters:</p>
<ul>
<li>
<p><code>reason</code><br />
  It is the reason identifier given as <a href="https://tools.ietf.org/html/draft-oberstet-hybi-tavendo-wamp-02#section-10.1.3">session close URI</a>. By default, Akka Wamp sends <code>wamp.error.close_realm</code></p>
</li>
<li>
<p><code>details</code><br />
  It is a dictionary of additional details. By default, Akka Wamp sends an empty dictionary.</p>
</li>
</ul>
<p>Some sending snippets are:</p>
<pre><code class="scala">connection ! Goodbye()
connection ! Goodbye(&quot;wamp.error.system_shutdown&quot;)
connection ! Goodbye(details = Dict().withEntry(reason -&gt; &quot;Serious error occured!&quot;))
</code></pre>

<p>A receiving snippet is:</p>
<pre><code class="scala">def opened: Receive = {
  case Goodbye(reason, details) =&gt;
    log warn s&quot;Router closed session because of $details&quot;
    connection ! Goodbye(&quot;wamp.error.goodbye_and_out&quot;)
    if (reason != &quot;wamp.error.system_shutdown&quot;)
      // why not requesting a new session 
      connection ! Hello
    else
      IO(Wamp) ! Connect(self)
}
</code></pre>

<blockquote>
<p>NOTE: there's an open [issue#242]((https://github.com/wamp-proto/wamp-proto/issues/242) on GitHub about the <code>Goodbye</code> message to warn you that some remote routers could decide to disconnect the transport in addition to close the session. If that happens the you'll be forced to reconnect.</p>
</blockquote>
<p><a name="Error"></a></p>
<h3 id="error">Error</h3>
<p>TBD</p>
<h2 id="publish-subscribe">Publish Subscribe</h2>
<p><a name="Subscribe"></a></p>
<h3 id="subscribe">Subscribe</h3>
<p>It is the message you send to the transport to subscribe to a topic. It can be constructed passing the following parameters:</p>
<ul>
<li>
<p><code>requestId</code>
  It is the request identifier you have to generate in <em>"session scope"</em>. AkkaWamp provides you with a <code>Scope.Session</code> trait you can mixin to invoke <code>nextId()</code></p>
</li>
<li>
<p><code>topic</code><br />
  It is the topic URI you want to subscribe to.</p>
</li>
<li>
<p><code>options</code><br />
  It is a dictionary of additional details. By default, Akka Wamp sends an empty dictionary.</p>
</li>
</ul>
<p>Examples:</p>
<pre><code class="scala">connection ! Subscribe(requestId = 34, &quot;myapp.tick.topic&quot;)
</code></pre>

<p><a name="Subscribed"></a></p>
<h3 id="subscribed">Subscribed</h3>
<p>TBD</p>
<p><a name="Publish"></a></p>
<h3 id="publish">Publish</h3>
<p>It is the message you send to the transport to publish an event. It can be constructed passing the following parameters:</p>
<ul>
<li>
<p><code>requestId</code><br />
  It is the request identifier you have to generate in <em>"session scope"</em>. AkkaWamp provides you with a <code>Scope.Session</code> trait you can mixin to invoke <code>nextId()</code></p>
</li>
<li>
<p><code>topic</code><br />
  It is the topic URI to which you wish to publish to</p>
</li>
<li>
<p><code>payload</code><br />
  It is the (option of) payload you could provide to send data arguments. By default, Akka Wamp sends none but you could create some as documented in the <a href="#payload">Payload</a> section below.</p>
</li>
<li>
<p><code>options</code><br />
  It is a dictionary of additional details (for example with the <code>"acknowledge" -&gt; true</code> entry if you wish to receive the <code>Published</code> message from the router). By default, Akka Wamp sends an empty dictionary.</p>
</li>
</ul>
<p>Examples:</p>
<pre><code class="scala">connection ! Publish(requestId = 34, &quot;myapp.tick.topic&quot;)

val list = Payload(&quot;paolo&quot;, 40, true)
connection ! Publish(nextId(), &quot;myapp.topic1&quot;, Some(list))

val mixed = Payload(&quot;paolo&quot;, &quot;age&quot;-&gt;40, true)
connection ! Publish(nextId(), &quot;myapp.topic1&quot;, Some(mixed))

connection ! Publish(89, &quot;myapp.topic3&quot;, options = Dict().withAcknowledge(true))
</code></pre>

<p><a name="Event"></a></p>
<h3 id="event">Event</h3>
<p>It is the message you receive from the remote router each time other clients have published to the same topics you subscribed to. It can be deconstructed (via Scala pattern matching) to the following parameters:</p>
<ul>
<li>
<p><code>subscriptionId</code>  <br />
  It is the subscription identifier you could use to figure out which topic the event has been fired for.</p>
</li>
<li>
<p><code>publicationId</code>  <br />
   It is the publication identifier generated by the remote router in global scope.</p>
</li>
<li>
<p><code>payload</code>  <br />
  It is the (option of) payload with data arguments you could read as documented in the <a href="#payload">Payload</a> section below.</p>
</li>
<li>
<p><code>details</code><br />
  It is a dictionary with additional details.</p>
</li>
</ul>
<p>Examples:</p>
<pre><code class="scala">val subscriptionId: Long = _

def opened: Receive = {
  case Event(subscriptionId, publicationId, None, details) =&gt;
    log debug s&quot;Event received for subscription $subscriptionId&quot;

  case Event(_, _, Some(payload), _) =&gt;
    log debug s&quot;Event receive with payload $payload&quot;
}
</code></pre>

<h2 id="remote-procedure-calls">Remote Procedure Calls</h2>
<p><a name="Register"></a></p>
<h3 id="register">Register</h3>
<p>TBD</p>
<p><a name="Call"></a></p>
<h3 id="call">Call</h3>
<p>TBD</p>
<p><a name="Invoke"></a></p>
<h3 id="invoke">Invoke</h3>
<p>TBD</p>
<p><a name="Yield"></a></p>
<h3 id="yield">Yield</h3>
<p>TBD</p>
<p><a name="Result"></a></p>
<h3 id="result">Result</h3>
<p>TBD</p></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '..';
    </script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
